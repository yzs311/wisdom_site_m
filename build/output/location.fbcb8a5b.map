{"version":3,"sources":["js/location.js"],"names":["$","pid","localStorage","getItem","height","map","marker","circle","polyline","AMap","Map","zoom","center","side","on","animate","left","value","val","ajax","type","url","data","id","string","dataType","success","console","log","html","length","i","hname","laowu","areaList","name","css","localtionList","temp","temp2","push","xloc","yloc","Marker","position","add","Circle","radius","fillColor","fillOpacity","strokeColor","strokeWeight","setZoomAndCenter","phone","imei","createDate","address","bat","calendar","datePicker","init","theSelectData","temp3","Polyline","path","lineJoin","showDir","remove","alert","title","projectHtml","subProjectHeight1","subProjectHeight2","nameHeight2","tempHtml","j","hireList","projectHeight","project","subProject","event","stopPropagation","addClass","removeClass"],"mappings":"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","file":"location.fbcb8a5b.map","sourceRoot":"..\\..","sourcesContent":["$(function(){\r\n    let pid = localStorage.getItem('pid')\r\n\r\n    // 手机长度适配\r\n    const height = $('body').height()\r\n    $('body').height(height)\r\n    // 初始化地图\r\n    let map = new AMap.Map('main',{\r\n        zoom: 12,\r\n        center: [114.083372,22.544146],\r\n    });\r\n\r\n    // 侧导航栏点击事件\r\n    let side = 0\r\n    $('.nav').on('click',function(){\r\n        if (side == 0) {\r\n            $('.side-box').animate({\r\n                left: '0'\r\n            })\r\n            $('.search').animate({\r\n                left: '135%'\r\n            })\r\n            side = 1\r\n        } else {\r\n            $('.side-box').animate({\r\n                left: '-3.2rem'\r\n            })\r\n            $('.search').animate({\r\n                left: '50%'\r\n            })\r\n            side = 0\r\n        }\r\n    })\r\n\r\n    // 监听输入框状态\r\n    $('#search').on('input propertychange',function(){\r\n        // console.log($(this).val())\r\n        let value = $(this).val()\r\n        $.ajax({\r\n            type: \"GET\",\r\n            url: \"http://39.108.103.150:8989/lz/hire/localtionList\",\r\n            data: {id:pid,string:value},\r\n            dataType: \"json\",\r\n            success: function (data) {\r\n                console.log(data)\r\n                let html = ''\r\n                if (data.length > 0) {\r\n                    for (let i = 0; i < data.length; i++) {\r\n                        html += \r\n                        `<li data-name=${data[i].hname}>\r\n                            <div class=\"left-img\"></div>\r\n                            <div class=\"content\">\r\n                                <div class=\"name\">\r\n                                    姓名：${data[i].hname}\r\n                                </div>\r\n                                <div class=\"company\">\r\n                                    所属公司：${data[i].laowu}\r\n                                </div>\r\n                                <div class=\"location\">\r\n                                    所属工区：${data[i].areaList[0].name}\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"right-img\"></div>\r\n                        </li>`\r\n                    }\r\n                    $('#searchList').html(html)\r\n                    $('.search-data').css('display','block')\r\n                } else {\r\n                    $('#searchList').html(\r\n                        `<li style=\"border-bottom:none\">\r\n                            <div class=\"content\" style=\"line-height:.7rem; text-align:center; font-size:.16rem\">\r\n                                无相关人员\r\n                            </div>\r\n                        </li>`\r\n                    )\r\n                    $('.search-data').css('display','block')\r\n                }\r\n            }\r\n        })\r\n        if (value == '') {\r\n            $('.search-data').css('display','none')\r\n        }\r\n    })\r\n\r\n    let marker   // 当前位置\r\n    let circle   // 电子围栏\r\n    let polyline // 历史轨迹\r\n    // 查看人员信息点击事件\r\n    $('#searchList').on('click','li',function(){\r\n        // console.log($(this).data('name'))\r\n        let name = $(this).data('name')\r\n        $('.history-box').css('display','none')\r\n        $.ajax({\r\n            type: \"GET\",\r\n            url: \"http://39.108.103.150:8989/lz/hire/localtionList\",\r\n            data: {id:pid,string:name},\r\n            dataType: \"json\",\r\n            // async: false,\r\n            success: function (data) {\r\n                // console.log(data)\r\n                if (data.length > 0) {\r\n                    if (data[0].localtionList.length > 0){\r\n                    let temp = []\r\n                    let temp2 = []\r\n                    temp.push(data[0].areaList[0].xloc)\r\n                    temp.push(data[0].areaList[0].yloc)\r\n                    temp2.push(data[0].localtionList[0].xloc)\r\n                    temp2.push(data[0].localtionList[0].yloc)\r\n                    $('.data-box').css('display','block')\r\n                    $('.search-data').css('display','none')\r\n                    marker = new AMap.Marker({\r\n                        position: temp2,   // 经纬度对象，也可以是经纬度构成的一维数组[116.39, 39.9]\r\n                    })\r\n                    map.add(marker)\r\n                    circle = new AMap.Circle({\r\n                        center: temp, // 圆心位置\r\n                        radius: data[0].areaList[0].radius,         // 圆半径\r\n                        fillColor: 'none',   // 圆形填充颜色\r\n                        fillOpacity: 0,      // 填充色透明度\r\n                        strokeColor: '#3979fe', // 描边颜色\r\n                        strokeWeight: 2,     // 描边宽度\r\n                    })\r\n                    map.add(circle)\r\n                    map.setZoomAndCenter(13, temp)\r\n                    $('#dataBox').html(\r\n                        `<div class=\"top-box\">\r\n                            <div class=\"list-box\">\r\n                                <ul>\r\n                                    <li class=\"name\">\r\n                                        姓名：${data[0].hname}\r\n                                    </li>\r\n                                    <li>\r\n                                        电话：${data[0].phone}\r\n                                    </li>\r\n                                    <li>\r\n                                        所属公司：${data[0].laowu}\r\n                                    </li>\r\n                                    <li>\r\n                                        设备编号：${data[0].imei}\r\n                                    </li>\r\n                                    <li>\r\n                                        定位时间：${data[0].localtionList[0].createDate}\r\n                                    </li>\r\n                                    <li>\r\n                                        定位地址：${data[0].localtionList[0].address}\r\n                                    </li>\r\n                                </ul>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"bottom-box\">\r\n                            <div class=\"electric\">\r\n                                电量：${data[0].localtionList[0].bat}%\r\n                            </div>\r\n                            <div class=\"refresh\">\r\n                                刷新定位\r\n                            </div>\r\n                            <div class=\"switchover\" id=\"history\" >\r\n                                历史轨迹\r\n                            </div>\r\n                        </div>`\r\n                    )\r\n                    let calendar = new datePicker()\r\n                    calendar.init({\r\n                        'trigger': '#history', /*按钮选择器，用于触发弹出插件*/\r\n                        'type': 'date',/*模式：date日期；datetime日期时间；time时间；ym年月；*/\r\n                        'minDate':'1900-1-1',/*最小日期*/\r\n                        'maxDate':'2100-12-31',/*最大日期*/\r\n                        'onSubmit':function(){/*确认时触发事件*/\r\n                            let theSelectData=calendar.value;\r\n                            // console.log(name)\r\n                            $.ajax({\r\n                                type: \"GET\",\r\n                                url: \"http://39.108.103.150:8989/lz/hire/localtionList\",\r\n                                data: {id:pid,string:name,createDate:theSelectData},\r\n                                dataType: \"json\",\r\n                                success: function (data) {\r\n                                    // console.log(data)\r\n                                    $('.data-box').css('display','none')\r\n                                    $('.history-box').css('display','block')\r\n                                    let temp = []\r\n                                    let temp2 = []\r\n                                    let temp3 = []\r\n                                    temp.push(data[0].areaList[0].xloc)\r\n                                    temp.push(data[0].areaList[0].yloc)\r\n                                    for (let i = 0; i < data[0].localtionList.length; i++) {\r\n                                        temp2 = []\r\n                                        temp2.push(data[0].localtionList[data[0].localtionList.length-1-i].xloc)\r\n                                        temp2.push(data[0].localtionList[data[0].localtionList.length-1-i].yloc)\r\n                                        temp3.push(temp2)\r\n                                    }\r\n                                    polyline = new AMap.Polyline({\r\n                                        path: temp3,\r\n                                        lineJoin: 'round', //折线拐点样式\r\n                                        showDir: true, //移动方向\r\n                                        strokeWeight: 3, //线条宽度\r\n                                        strokeColor: '#3366ff', //线条颜色\r\n                                    })\r\n                                    map.add(polyline)\r\n                                    map.remove(marker)\r\n                                    map.setZoomAndCenter(13, temp)\r\n\r\n                                    $('#historyBox').html(\r\n                                        `<div class=\"top-box\" id=\"historyTop\">\r\n                                            <div class=\"pull-up\"></div>\r\n                                            <div class=\"list-box\">\r\n                                                <ul>\r\n                                                    <li class=\"name\">\r\n                                                        姓名：${data[0].hname}\r\n                                                    </li>\r\n                                                    <li>\r\n                                                        电话：${data[0].phone}\r\n                                                    </li>\r\n                                                    <li>\r\n                                                        所属公司：${data[0].laowu}\r\n                                                    </li>\r\n                                                    <li>\r\n                                                        设备编号：${data[0].imei}\r\n                                                    </li>\r\n                                                </ul>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"middle-box\" id=\"historyMiddle\">\r\n                                            <div class=\"enter\">\r\n                                                <div class=\"img-box\"></div>\r\n                                                <ul>\r\n                                                    <li>\r\n                                                        设备电量：${data[0].localtionList[0].bat}%\r\n                                                    </li>\r\n                                                    <li>\r\n                                                        时间：${data[0].localtionList[0].createDate}\r\n                                                        <br>\r\n\r\n                                                    </li>\r\n                                                    <li>\r\n                                                        位置：${data[0].localtionList[0].address}\r\n                                                    </li>\r\n                                                </ul>\r\n                                            </div>\r\n                                            <div class=\"come\">\r\n                                                <div class=\"img-box\"></div>\r\n                                                <ul>\r\n                                                    <li>\r\n                                                        设备电量：${data[0].localtionList[data[0].localtionList.length-1].bat}%\r\n                                                    </li>\r\n                                                    <li>\r\n                                                        时间：${data[0].localtionList[data[0].localtionList.length-1].createDate}\r\n                                                        <br>\r\n\r\n                                                    </li>\r\n                                                    <li>\r\n                                                        位置：${data[0].localtionList[data[0].localtionList.length-1].address}\r\n                                                    </li>\r\n                                                </ul>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"bottom-box\">\r\n                                            <div class=\"electric\">\r\n                                                电量：${data[0].localtionList[0].bat}%\r\n                                            </div>\r\n                                            <div class=\"refresh\">\r\n                                                刷新定位\r\n                                            </div>\r\n                                            <div class=\"switchover\" id=\"particular\">\r\n                                                个人详情\r\n                                            </div>\r\n                                        </div>`\r\n                                    )\r\n                                }\r\n                            })\r\n                        },\r\n                        'onClose':function(){/*取消时触发事件*/\r\n                            // console.log(`123`)\r\n                        }\r\n                    })\r\n                    } else {\r\n                        alert('此设备已关机！')\r\n                    }\r\n                } else {\r\n                    alert('此设备已关机！')\r\n                }\r\n            }\r\n        })\r\n    })\r\n\r\n    // 人员信息与历史轨迹切换\r\n    $('#historyBox').on('click','#particular',function(){\r\n        $('.data-box').css('display','block')\r\n        $('.history-box').css('display','none')\r\n        map.add(marker)\r\n        map.remove(polyline)\r\n    })\r\n\r\n    let temp = 1\r\n    // 历史轨迹详细信息\r\n    $('#historyBox').on('click','#historyTop',function(){\r\n        // console.log(`123`)\r\n        if (temp == 1) {\r\n            $('#historyMiddle').animate({\r\n                height: '1.705rem'\r\n            })\r\n            $('.pull-up').css('transform','rotate(180deg)')\r\n            temp = 0\r\n        } else {\r\n            $('#historyMiddle').animate({\r\n                height: '0'\r\n            })\r\n            $('.pull-up').css('transform','rotate(0deg)')\r\n            temp = 1\r\n        }\r\n    })\r\n        \r\n    // 获取工区数据\r\n    $.ajax({\r\n        type: \"GET\",\r\n        url: \"http://39.108.103.150:8989/lz/project/listzh\",\r\n        data: {id:pid},\r\n        dataType: \"json\",\r\n        success: function(data) {\r\n            // console.log(data)\r\n            $('#sideBox').html(\r\n                `<div class=\"project\" id=\"project\">\r\n                    ${data.title}\r\n                    <i class=\"blue-v\"></i>\r\n                </div>`\r\n            )\r\n            let projectHtml =  $('#project').html()\r\n            for (let i = 0; i < data.areaList.length; i++) {\r\n                // console.log(projectHtml)\r\n                projectHtml += \r\n                `<div class=\"sub-project\" id=\"subProject${i}\">\r\n                    ${data.areaList[i].name}\r\n                    <i class=\"black-v\"></i>\r\n                    <div class=\"name-box\">\r\n                        \r\n                    </div>\r\n                </div>`\r\n            }\r\n            $('#project').html(projectHtml)\r\n\r\n            let subProjectHeight1 = $(`#subProject0`).height()\r\n            let nameHeight1 = $(`#subProject0 .name-box`).height()\r\n            // console.log(subProjectHeight1)\r\n            let subProjectHeight2 = 0\r\n            let nameHeight2 = 0\r\n            for (let i = 0; i < data.areaList.length; i++) {\r\n                let tempHtml = ''\r\n                for (let j = 0; j < data.areaList[i].hireList.length; j++) {\r\n                    tempHtml += \r\n                    `<div class=\"name\" data-name=${data.areaList[i].hireList[j].hname}>\r\n                        <span>${data.areaList[i].hireList[j].hname}</span>\r\n                        <span class=${data.areaList[i].hireList[j].xloc!=null?'online':'offline'}>${data.areaList[i].hireList[j].xloc!=null?'在线':'不在线'}</span>\r\n                    </div>`\r\n                }\r\n                $(`#subProject${i} .name-box`).html(tempHtml)\r\n                // console.log( $(`#subProject${i} .name-box`).html())\r\n\r\n                subProjectHeight2 += $(`#subProject${i}`).height()\r\n                // console.log(subProjectHeight2)\r\n                nameHeight2 += $(`#subProject${i} .name-box`).height()\r\n                let projectHeight = $('#project').height()\r\n                let project = 1\r\n                let subProject = 1\r\n                // 一级菜单\r\n                $('#project').on('click',function(event){\r\n                    // console.log($('#subProject').height())\r\n                    event.stopPropagation()\r\n                    if (project == 1) {\r\n                        $('#project').animate({\r\n                            height: (projectHeight+subProjectHeight2+nameHeight2)+'px'\r\n                        })\r\n                        project = 0\r\n                        $('.blue-v').addClass('rotate')\r\n                    } else {\r\n                        $('#project').animate({\r\n                            height: projectHeight+'px'\r\n                        })\r\n                        $('.blue-v').removeClass('rotate')\r\n                        project = 1\r\n                    }\r\n                })\r\n            \r\n                // 二级菜单\r\n                $(`#subProject${i}`).on('click',function(event){\r\n                    // 阻止事件冒泡\r\n                    event.stopPropagation()\r\n                    // console.log(subProjectHeight2)        \r\n                    if (subProject == 1) {\r\n                        $(`#subProject${i}`).animate({\r\n                            height: (subProjectHeight2+nameHeight2)+'px'\r\n                        })\r\n                        $(`#subProject${i} .black-v`).addClass('rotate')\r\n                        subProject = 0\r\n                    } else {\r\n                        $(`#subProject${i}`).animate({\r\n                            height: subProjectHeight1+'px'\r\n                        })\r\n                        $(`#subProject${i} .black-v`).removeClass('rotate')\r\n                        subProject = 1\r\n                    }\r\n                })\r\n\r\n                // 人员点击事件\r\n                $('.name').on('click',function (event) {\r\n                    event.stopPropagation()\r\n                    // console.log($(this).data('name'))\r\n                    let name = $(this).data('name')\r\n                    $('.history-box').css('display','none')\r\n                    $.ajax({\r\n                        type: \"GET\",\r\n                        url: \"http://39.108.103.150:8989/lz/hire/localtionList\",\r\n                        data: {id:pid,string:name},\r\n                        dataType: \"json\",\r\n                        // async: false,\r\n                        success: function (data) {\r\n                            // console.log(data)\r\n                            if (data.length > 0) {\r\n                                if (data[0].localtionList.length > 0){\r\n                                $('.side-box').animate({\r\n                                    left: '-3.2rem'\r\n                                })\r\n                                $('.search').animate({\r\n                                    left: '50%'\r\n                                })\r\n                                side = 0\r\n                                let temp = []\r\n                                let temp2 = []\r\n                                temp.push(data[0].areaList[0].xloc)\r\n                                temp.push(data[0].areaList[0].yloc)\r\n                                temp2.push(data[0].localtionList[0].xloc)\r\n                                temp2.push(data[0].localtionList[0].yloc)\r\n                                $('.data-box').css('display','block')\r\n                                $('.search-data').css('display','none')\r\n                                marker = new AMap.Marker({\r\n                                    position: temp2,   // 经纬度对象，也可以是经纬度构成的一维数组[116.39, 39.9]\r\n                                })\r\n                                map.add(marker)\r\n                                circle = new AMap.Circle({\r\n                                    center: temp, // 圆心位置\r\n                                    radius: data[0].areaList[0].radius,         // 圆半径\r\n                                    fillColor: 'none',   // 圆形填充颜色\r\n                                    fillOpacity: 0,      // 填充色透明度\r\n                                    strokeColor: '#3979fe', // 描边颜色\r\n                                    strokeWeight: 2,     // 描边宽度\r\n                                })\r\n                                map.add(circle)\r\n                                map.setZoomAndCenter(13, temp)\r\n                                $('#dataBox').html(\r\n                                    `<div class=\"top-box\">\r\n                                        <div class=\"list-box\">\r\n                                            <ul>\r\n                                                <li class=\"name\">\r\n                                                    姓名：${data[0].hname}\r\n                                                </li>\r\n                                                <li>\r\n                                                    电话：${data[0].phone}\r\n                                                </li>\r\n                                                <li>\r\n                                                    所属公司：${data[0].laowu}\r\n                                                </li>\r\n                                                <li>\r\n                                                    设备编号：${data[0].imei}\r\n                                                </li>\r\n                                                <li>\r\n                                                    定位时间：${data[0].localtionList[0].createDate}\r\n                                                </li>\r\n                                                <li>\r\n                                                    定位地址：${data[0].localtionList[0].address}\r\n                                                </li>\r\n                                            </ul>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class=\"bottom-box\">\r\n                                        <div class=\"electric\">\r\n                                            电量：${data[0].localtionList[0].bat}%\r\n                                        </div>\r\n                                        <div class=\"refresh\">\r\n                                            刷新定位\r\n                                        </div>\r\n                                        <div class=\"switchover\" id=\"history\" >\r\n                                            历史轨迹\r\n                                        </div>\r\n                                    </div>`\r\n                                )\r\n                                let calendar = new datePicker();\r\n                                calendar.init({\r\n                                    'trigger': '#history', /*按钮选择器，用于触发弹出插件*/\r\n                                    'type': 'date',/*模式：date日期；datetime日期时间；time时间；ym年月；*/\r\n                                    'minDate':'1900-1-1',/*最小日期*/\r\n                                    'maxDate':'2100-12-31',/*最大日期*/\r\n                                    'onSubmit':function(){/*确认时触发事件*/\r\n                                        let theSelectData=calendar.value;\r\n                                        // console.log(name)\r\n                                        $.ajax({\r\n                                            type: \"GET\",\r\n                                            url: \"http://39.108.103.150:8989/lz/hire/localtionList\",\r\n                                            data: {id:pid,string:name,createDate:theSelectData},\r\n                                            dataType: \"json\",\r\n                                            success: function (data) {\r\n                                                // console.log(data)\r\n                                                $('.data-box').css('display','none')\r\n                                                $('.history-box').css('display','block')\r\n                                                let temp = []\r\n                                                let temp2 = []\r\n                                                let temp3 = []\r\n                                                temp.push(data[0].areaList[0].xloc)\r\n                                                temp.push(data[0].areaList[0].yloc)\r\n                                                for (let i = 0; i < data[0].localtionList.length; i++) {\r\n                                                    temp2 = []\r\n                                                    temp2.push(data[0].localtionList[data[0].localtionList.length-1-i].xloc)\r\n                                                    temp2.push(data[0].localtionList[data[0].localtionList.length-1-i].yloc)\r\n                                                    temp3.push(temp2)\r\n                                                }\r\n                                                polyline = new AMap.Polyline({\r\n                                                    path: temp3,\r\n                                                    lineJoin: 'round', //折线拐点样式\r\n                                                    showDir: true, //移动方向\r\n                                                    strokeWeight: 3, //线条宽度\r\n                                                    strokeColor: '#3366ff', //线条颜色\r\n                                                })\r\n                                                map.add(polyline)\r\n                                                map.remove(marker)\r\n                                                map.setZoomAndCenter(13, temp)\r\n                                            \r\n                                                $('#historyBox').html(\r\n                                                    `<div class=\"top-box\" id=\"historyTop\">\r\n                                                        <div class=\"pull-up\"></div>\r\n                                                        <div class=\"list-box\">\r\n                                                            <ul>\r\n                                                                <li class=\"name\">\r\n                                                                    姓名：${data[0].hname}\r\n                                                                </li>\r\n                                                                <li>\r\n                                                                    电话：${data[0].phone}\r\n                                                                </li>\r\n                                                                <li>\r\n                                                                    所属公司：${data[0].laowu}\r\n                                                                </li>\r\n                                                                <li>\r\n                                                                    设备编号：${data[0].imei}\r\n                                                                </li>\r\n                                                            </ul>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div class=\"middle-box\" id=\"historyMiddle\">\r\n                                                        <div class=\"enter\">\r\n                                                            <div class=\"img-box\"></div>\r\n                                                            <ul>\r\n                                                                <li>\r\n                                                                    设备电量：${data[0].localtionList[0].bat}%\r\n                                                                </li>\r\n                                                                <li>\r\n                                                                    时间：${data[0].localtionList[0].createDate}\r\n                                                                    <br>\r\n                                                \r\n                                                                </li>\r\n                                                                <li>\r\n                                                                    位置：${data[0].localtionList[0].address}\r\n                                                                </li>\r\n                                                            </ul>\r\n                                                        </div>\r\n                                                        <div class=\"come\">\r\n                                                            <div class=\"img-box\"></div>\r\n                                                            <ul>\r\n                                                                <li>\r\n                                                                    设备电量：${data[0].localtionList[data[0].localtionList.length-1].bat}%\r\n                                                                </li>\r\n                                                                <li>\r\n                                                                    时间：${data[0].localtionList[data[0].localtionList.length-1].createDate}\r\n                                                                    <br>\r\n                                                \r\n                                                                </li>\r\n                                                                <li>\r\n                                                                    位置：${data[0].localtionList[data[0].localtionList.length-1].address}\r\n                                                                </li>\r\n                                                            </ul>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div class=\"bottom-box\">\r\n                                                        <div class=\"electric\">\r\n                                                            电量：${data[0].localtionList[0].bat}%\r\n                                                        </div>\r\n                                                        <div class=\"refresh\">\r\n                                                            刷新定位\r\n                                                        </div>\r\n                                                        <div class=\"switchover\" id=\"particular\">\r\n                                                            个人详情\r\n                                                        </div>\r\n                                                    </div>`\r\n                                                )\r\n                                            }\r\n                                        })\r\n                                    },\r\n                                    'onClose':function(){/*取消时触发事件*/\r\n                                        // console.log(`123`)\r\n                                    }\r\n                                })\r\n                                } else {\r\n                                    alert('此设备已关机！')\r\n                                }\r\n                            } else {\r\n                                alert('此设备已关机！')\r\n                            }\r\n                        }\r\n                    })\r\n                })\r\n            }\r\n        }\r\n    })\r\n\r\n})"]}