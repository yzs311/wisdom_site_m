{"version":3,"sources":["js/establish.js"],"names":["$","pid","localStorage","getItem","place","unitId","fileUrl","describex","rank","deadlineTime","rectification","on","click","change","e","css","headers","temp","target","files","file","FormData","append","axios","post","then","res","attr","data","fileimgurl","html","i","msg","length","id","title","event","stopPropagation","text","calendar","datePicker","init","theSelectData","value","addClass","siblings","removeClass","val","console","log","location","alert"],"mappings":";AAAAA,EAAE,WAEMC,IAAAA,EAAMC,aAAaC,QAAQ,OAG3BC,EAAQ,GACRC,EAAS,GACTC,EAAU,GACVC,EAAY,GACZC,EAAO,EACPC,EAAe,GACfC,EAAgB,GAGpBV,EAAE,WAAWW,GAAG,QAAQ,WACpBX,EAAE,WAAWY,UAIjBZ,EAAE,WAAWa,OAAO,SAASC,GACzBd,EAAE,WAAWe,IAAI,UAAU,QAC3Bf,EAAE,cAAce,IAAI,UAAU,SAC1BC,IACAC,EAAOH,EAAEI,OAAOC,MAAM,GAC1BC,KAAO,IAAIC,SACXD,KAAKE,OAAO,OAAOL,GAEnBM,MAAMC,KAA8DJ,yDAAAA,KALtD,CAACJ,QAAS,CAAiB,eAAA,yBAKyCS,KAC9E,SAAAC,GAEI1B,EAAE,WAAW2B,KAAK,MAAMD,EAAIE,KAAKA,KAAK,GAAGC,YACzC7B,EAAE,WAAWe,IAAI,UAAU,SAC3Bf,EAAE,cAAce,IAAI,UAAU,QAC9BT,EAAUoB,EAAIE,KAAKA,KAAK,GAAGC,eAOnCN,MAAMC,KAA8EvB,yEAAAA,OAAAA,IAAOwB,KACvF,SAAAC,GAGS,IADDI,IAAAA,EAAO,GACFC,EAAI,EAAGA,EAAIL,EAAIE,KAAKI,IAAIC,OAAQF,IACrCD,GACwBJ,oBAAAA,OAAAA,EAAIE,KAAKI,IAAID,GAAGG,GAAOR,MAAAA,OAAAA,EAAIE,KAAKI,IAAID,GAAGI,MAD/D,SAGJnC,EAAE,gBAAgB8B,KAAKA,GAGvB9B,EAAE,mBAAmBW,GAAG,QAAQ,SAASyB,GACrCA,EAAMC,kBACNrC,EAAE,aAAae,IAAI,UAAU,QAG7BV,EAASL,EAAE,MAAM4B,KAAK,UACtB5B,EAAE,eAAe8B,KAAQ9B,GAAAA,OAAAA,EAAE,MAAMsC,OAAjC,gBASZC,IAAAA,EAAW,IAAIC,WACnBD,EAASE,KAAK,CACC,QAAA,YACH,KAAA,OACE,QAAA,WACA,QAAA,aACC,SAAA,WACHC,IAAAA,EAAgBH,EAASI,MAE7B3C,EAAE,kBAAkB8B,KAAKY,GACzBjC,EAAeiC,GAET,QAAA,eAMd1C,EAAE,yBAAyBW,GAAG,QAAQ,WAClCX,EAAE,MAAM4C,SAAS,UAAUC,WAAWC,YAAY,UAElDtC,EAAOR,EAAE,MAAM4B,KAAK,UAIxB5B,EAAE,SAASW,GAAG,QAAQ,WAClBX,EAAE,aAAae,IAAI,UAAU,WAIjCf,EAAE,gBAAgBW,GAAG,QAAQ,WACzBP,EAAQJ,EAAE,mBAAmB+C,MAE7BxC,EAAYP,EAAE,sBAAsB+C,MAEpCrC,EAAgBV,EAAE,qBAAqB+C,MAEvCxB,MAAMC,KAA+DpB,0DAAAA,OAAAA,EAAmBG,eAAAA,OAAAA,EAA2BG,mBAAAA,OAAAA,EAAwBL,YAAAA,OAAAA,EAAkBC,aAAAA,OAAAA,EAAgBE,UAAAA,OAAAA,EAAqBC,kBAAAA,OAAAA,EAA0BR,eAAAA,OAAAA,IAAOwB,KAC/N,SAAAC,GACIsB,QAAQC,IAAIvB,EAAIE,MACE,SAAdF,EAAIE,KAAKI,IACTkB,SAAW,6BAEXC,MAAM","file":"establish.2f2d763f.map","sourceRoot":"..\\..","sourcesContent":["$(function(){\r\n    // console.log('hello world')\r\n    let pid = localStorage.getItem('pid')\r\n\r\n    // 创建整改单需要上传的数据\r\n    let place = ''      // 具体位置\r\n    let unitId = ''     // 分包单位id\r\n    let fileUrl = ''    // 照片路径\r\n    let describex = ''  // 问题描述\r\n    let rank = 1       // 问题级别\r\n    let deadlineTime = '' // 整改期限\r\n    let rectification = '' // 整改要求\r\n\r\n    // 添加照片点击事件\r\n    $('.addPic').on('click',function(){\r\n        $('.camera').click()\r\n    })\r\n\r\n    // 照片上传\r\n    $(\".camera\").change(function(e){\r\n        $('.addPic').css('display','none')\r\n        $('.uploading').css('display','block')\r\n        let headers = {headers: {\"Content-Type\": \"multipart/form-data\"}}\r\n        let temp = e.target.files[0]\r\n        file = new FormData() // 创建form对象\r\n        file.append('file',temp) // 通过append向form对象添加数据\r\n        // console.log(file.get('file')) //FormData私有类对象，访问不到，可以通过get判断值是否传进去\r\n        axios.post(`http://39.108.103.150:8989/lz/file/upload?folderName=1`,file,headers).then(\r\n            res => {\r\n                // console.log(res.data.data[0].fileimgurl)\r\n                $('.addPic').attr('src',res.data.data[0].fileimgurl)\r\n                $('.addPic').css('display','block')\r\n                $('.uploading').css('display','none')\r\n                fileUrl = res.data.data[0].fileimgurl\r\n            }\r\n        )\r\n    })\r\n\r\n    // 获取分包单位列表\r\n    function getQueryBuildCompanyInFo () {\r\n        axios.post(`http://39.108.103.150:8989/lz/polling/queryBuildCompanyInFo?projectId=${pid}`).then(\r\n            res => {\r\n                // console.log(res.data)\r\n                let html = ''\r\n                for (let i = 0; i < res.data.msg.length; i++) {\r\n                    html += \r\n                        `<li data-unitid=\"${res.data.msg[i].id}\">${res.data.msg[i].title}</li>`\r\n                }\r\n                $('.unit-box ul').html(html)\r\n\r\n                // 分包单位选项栏点击事件\r\n                $('.unit-box ul li').on('click',function(event){\r\n                    event.stopPropagation()\r\n                    $('.unit-box').css('display','none')\r\n                    // $('.shade-box').css('display','none')\r\n                    // console.log($(this).data('unitid'))\r\n                    unitId = $(this).data('unitid')\r\n                    $('.unit .text').html(`${$(this).text()}<i></i>`)\r\n                })\r\n            }\r\n        )\r\n    }\r\n\r\n    getQueryBuildCompanyInFo()\r\n\r\n    // 设置整改期限\r\n    let calendar = new datePicker()\r\n    calendar.init({\r\n        'trigger': '.deadline', /*按钮选择器，用于触发弹出插件*/\r\n        'type': 'date',/*模式：date日期；datetime日期时间；time时间；ym年月；*/\r\n        'minDate':'1900-1-1',/*最小日期*/\r\n        'maxDate':'2100-12-31',/*最大日期*/\r\n        'onSubmit':function(){/*确认时触发事件*/\r\n            let theSelectData = calendar.value;\r\n            // console.log(theSelectData)\r\n            $('.deadline span').html(theSelectData)\r\n            deadlineTime = theSelectData\r\n        },\r\n        'onClose':function(){/*取消时触发事件*/\r\n            // console.log(`123`)\r\n        }\r\n    })\r\n\r\n    // 问题级别选择\r\n    $('.rank .button-box div').on('click',function(){\r\n        $(this).addClass('active').siblings().removeClass('active')\r\n        // console.log($(this).data('rank'))\r\n        rank = $(this).data('rank')\r\n    })\r\n\r\n    // 选择分包单位\r\n    $('.unit').on('click',function(){\r\n        $('.unit-box').css('display','block')\r\n    })\r\n\r\n    // 创建巡检单\r\n    $('.countersign').on('click',function(){\r\n        place = $('.position input').val()\r\n        // console.log(place)\r\n        describex = $('.describe textarea').val()\r\n        // console.log(describex)\r\n        rectification = $('.require textarea').val()\r\n        // console.log(rectification)\r\n        axios.post(`http://39.108.103.150:8989/lz/polling/addPolling?place=${place}&describex=${describex}&rectification=${rectification}&unitId=${unitId}&fileUrl=${fileUrl}&rank=${rank}&deadlineTime=${deadlineTime}&projectId=${pid}`).then(\r\n            res => {\r\n                console.log(res.data)\r\n                if (res.data.msg=='发起成功！') {\r\n                    location = '../components/quality.html'\r\n                } else {\r\n                    alert('')\r\n                }\r\n            }\r\n        )\r\n    })\r\n})"]}