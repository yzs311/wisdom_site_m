{"version":3,"sources":["js/establish.js"],"names":["$","pid","localStorage","getItem","place","unitId","fileUrl","describex","rank","deadlineTime","rectification","on","click","change","e","css","headers","temp","target","files","file","FormData","append","axios","post","then","res","attr","data","fileimgurl","getQueryBuildCompanyInFo","html","i","msg","length","id","title","event","stopPropagation","text","calendar","datePicker","init","theSelectData","value","addClass","siblings","removeClass","val","console","log","location","alert"],"mappings":"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","file":"establish.25be478c.map","sourceRoot":"..","sourcesContent":["$(function(){\r\n    // console.log('hello world')\r\n    let pid = localStorage.getItem('pid')\r\n\r\n    // 创建整改单需要上传的数据\r\n    let place = ''      // 具体位置\r\n    let unitId = ''     // 分包单位id\r\n    let fileUrl = ''    // 照片路径\r\n    let describex = ''  // 问题描述\r\n    let rank = 1       // 问题级别\r\n    let deadlineTime = '' // 整改期限\r\n    let rectification = '' // 整改要求\r\n\r\n    // 添加照片点击事件\r\n    $('.addPic').on('click',function(){\r\n        $('.camera').click()\r\n    })\r\n\r\n    // 照片上传\r\n    $(\".camera\").change(function(e){\r\n        $('.addPic').css('display','none')\r\n        $('.uploading').css('display','block')\r\n        let headers = {headers: {\"Content-Type\": \"multipart/form-data\"}}\r\n        let temp = e.target.files[0]\r\n        file = new FormData() // 创建form对象\r\n        file.append('file',temp) // 通过append向form对象添加数据\r\n        // console.log(file.get('file')) //FormData私有类对象，访问不到，可以通过get判断值是否传进去\r\n        axios.post(`http://39.108.103.150:8989/lz/file/upload?folderName=1`,file,headers).then(\r\n            res => {\r\n                // console.log(res.data.data[0].fileimgurl)\r\n                $('.addPic').attr('src',res.data.data[0].fileimgurl)\r\n                $('.addPic').css('display','block')\r\n                $('.uploading').css('display','none')\r\n                fileUrl = res.data.data[0].fileimgurl\r\n            }\r\n        )\r\n    })\r\n\r\n    // 获取分包单位列表\r\n    function getQueryBuildCompanyInFo () {\r\n        axios.post(`http://39.108.103.150:8989/lz/polling/queryBuildCompanyInFo?projectId=${pid}`).then(\r\n            res => {\r\n                // console.log(res.data)\r\n                let html = ''\r\n                for (let i = 0; i < res.data.msg.length; i++) {\r\n                    html += \r\n                        `<li data-unitid=\"${res.data.msg[i].id}\">${res.data.msg[i].title}</li>`\r\n                }\r\n                $('.unit-box ul').html(html)\r\n\r\n                // 分包单位选项栏点击事件\r\n                $('.unit-box ul li').on('click',function(event){\r\n                    event.stopPropagation()\r\n                    $('.unit-box').css('display','none')\r\n                    // $('.shade-box').css('display','none')\r\n                    // console.log($(this).data('unitid'))\r\n                    unitId = $(this).data('unitid')\r\n                    $('.unit .text').html(`${$(this).text()}<i></i>`)\r\n                })\r\n            }\r\n        )\r\n    }\r\n\r\n    getQueryBuildCompanyInFo()\r\n\r\n    // 设置整改期限\r\n    let calendar = new datePicker()\r\n    calendar.init({\r\n        'trigger': '.deadline', /*按钮选择器，用于触发弹出插件*/\r\n        'type': 'date',/*模式：date日期；datetime日期时间；time时间；ym年月；*/\r\n        'minDate':'1900-1-1',/*最小日期*/\r\n        'maxDate':'2100-12-31',/*最大日期*/\r\n        'onSubmit':function(){/*确认时触发事件*/\r\n            let theSelectData = calendar.value;\r\n            // console.log(theSelectData)\r\n            $('.deadline span').html(theSelectData)\r\n            deadlineTime = theSelectData\r\n        },\r\n        'onClose':function(){/*取消时触发事件*/\r\n            // console.log(`123`)\r\n        }\r\n    })\r\n\r\n    // 问题级别选择\r\n    $('.rank .button-box div').on('click',function(){\r\n        $(this).addClass('active').siblings().removeClass('active')\r\n        // console.log($(this).data('rank'))\r\n        rank = $(this).data('rank')\r\n    })\r\n\r\n    // 选择分包单位\r\n    $('.unit').on('click',function(){\r\n        $('.unit-box').css('display','block')\r\n    })\r\n\r\n    // 创建巡检单\r\n    $('.countersign').on('click',function(){\r\n        place = $('.position input').val()\r\n        // console.log(place)\r\n        describex = $('.describe textarea').val()\r\n        // console.log(describex)\r\n        rectification = $('.require textarea').val()\r\n        // console.log(rectification)\r\n        axios.post(`http://39.108.103.150:8989/lz/polling/addPolling?place=${place}&describex=${describex}&rectification=${rectification}&unitId=${unitId}&fileUrl=${fileUrl}&rank=${rank}&deadlineTime=${deadlineTime}&projectId=${pid}`).then(\r\n            res => {\r\n                console.log(res.data)\r\n                if (res.data.msg=='发起成功！') {\r\n                    location = '../components/quality.html'\r\n                } else {\r\n                    alert('')\r\n                }\r\n            }\r\n        )\r\n    })\r\n})"]}